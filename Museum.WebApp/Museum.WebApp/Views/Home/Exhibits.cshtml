@using Museum.WebApp.Models;

@model IEnumerable<Museum.WebApp.Models.ExhibitViewModel>
@{
    ViewBag.Title = "Exhibits";
}

<div class="content-wrapper">
    <article class="exhibit-list">
        <h2>Exhibits</h2>
        @foreach(var exhibit in Model)
        {
            var artifactForDisplay = new ArtifactViewModel();
            artifactForDisplay.Title = "Artifact Image Placeholder";

            if (exhibit.Artifacts != null && exhibit.Artifacts.Count() > 0)
            {
                artifactForDisplay = exhibit.Artifacts.ToList<ArtifactViewModel>()[0]; 
            }    
        
            <div>
                <img src="@artifactForDisplay.ImageUrl" alt="@artifactForDisplay.Title"
                    width="80" height="160" />
                <h3><a href="/home/gallery/@exhibit.Id">@exhibit.Title</a> by @exhibit.CreatedByUser.UserName</h3>
                <h4>@exhibit.CreatedAtString</h4>
                <p>@exhibit.Description</p>
            </div>
        }
    </article>
    <aside class="tags">
        <h2>Exhibits by Tag</h2>
        <div id="TagCloud"></div>
    </aside>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $.getJSON("/api/tags", null, function (data) {
            if (data) {
                data.forEach(function (tag) {
                    $('#TagCloud').append('<a href="/home/Exhibits/' + tag + '" class="tag-link">' + tag + '</a>');
                });                
            }
        });
    });
</script>